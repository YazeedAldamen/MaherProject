@model AdminDashboard.Models.RoomListViewModel
@{
    ViewData["Title"] = "Edit Hotel Rooms";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}
@section DataTable {
    <partial name="_DataTableCSSPartial" />
    <partial name="_DataTableScriptsPartial" />
}
<div class="col-lg-9 col-md-12 px-4 mt-3">
    <div class="body-contant">
        <h1 class="mb-5">@ViewData["Title"]</h1>
         @foreach(var room in Model.Rooms){
                <div class="card mb-4 border-0 shadow">
                    <div class="row g-0 p-3 align-items-center">
                        <div class="col-md-5 mb-lg-0 mb-md-0 mb-3">
                            <img src="../../images/content/@room.HotelMainImage" class="img-fluid rounded">
                        </div>
                        <div class="col-md-5 px-lg-3 px-md-3 px-0">
                            <h5 class="mb-3">@room.HotelName</h5>
                            <div class="features mb-4">
                                <h6 class="mb-1">Features</h6>
                                <span class="badge rounded-pill bg-light text-dark text-wrap">
                                    <i class='bx bx-bed'></i>@room.NumberOfBeds Beds
                                </span>
                                <span class="badge rounded-pill bg-light text-dark text-wrap">
                                    <i class='bx bx-bath'></i>@room.NumberOfBathrooms Bathroom
                                </span>
                                <span class="badge rounded-pill bg-light text-dark text-wrap">
                                    <i class='bx bx-chair'></i>@room.NumberOfSofas Sofa
                                </span>
                            </div>
                            <div class="Facilities mb-3">
                                <h6 class="mb-1">Facilities</h6>
                                @{
                                    if (room.IsWifi)
                                    {
                                            <span class="badge rounded-pill bg-light text-dark text-wrap">
                                                <i class='bx bx-wifi'></i>Wifi
                                            </span>
                                    }
                                    if (room.IsTV)
                                    {
                                            <span class="badge rounded-pill bg-light text-dark text-wrap">
                                                <i class='bx bx-tv'></i>Television
                                                </span>
                                        }
                                    if (room.IsAC)
                                    {
                                            <span class="badge rounded-pill bg-light text-dark text-wrap">
                                                <i class='bx bx-wind'></i>AC
                                                </span>
                                        }
                                    if (room.IsRoomHeater)
                                    {
                                            <span class="badge rounded-pill bg-light text-dark text-wrap">
                                                <i class='bx bxs-hot'></i>Room Heater
                                            </span>
                                    }
                                }
                            </div>
                            <div class="guests">
                                <h6 class="mb-1">Guests</h6>
                                <span class="badge rounded-pill bg-light text-dark text-wrap">
                                    <i class='bx bx-child'></i>@room.NumberOfAdults Adults
                                </span>
                                <span class="badge rounded-pill bg-light text-dark text-wrap">
                                    <i class='bx bx-child'></i>@room.NumberOfChildren Children
                                </span>
                            </div>
                        </div>
                    <div class="col-md-2 mt-lg-0 mt-md-0 mt-4 text-center">
                        <h6 class="mb-4">@room.Price JD</h6>
                        <div class="btn-group">
                            <a href="@Url.Action("Delete","HotelRooms",new{Id=room.Id})" class="btn btn-danger delete-link">Delete</a>
                            &nbsp;
                            @if (room.IsPublished)
                            {
                                <a href="@Url.Action("Hide","HotelRooms",new{Id=room.Id})" class="btn btn-secondary">Hide</a>
                            }
                            else
                            {
                                <a href="@Url.Action("Show","HotelRooms",new{Id=room.Id})" class="btn btn-success">Show</a>
                            }
                        </div>
                        <button type="button" class="btn btn-primary mt-3 edit-price-btn" data-bs-toggle="modal" data-bs-target="#exampleModal" onclick="setModalContent('@room.Id')">Edit Price</button>

                    </div>
                    </div>
                </div>

            
            }
        <nav aria-label="Page navigation">
            <ul class="pagination">
                @if (ViewBag.Page > 1)
                {
                    <li class="page-item">
                        <a class="page-link" href="@Url.Action("Index","HotelRooms",new {page=1})">First</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="@Url.Action("Index","HotelRooms",new {page=ViewBag.Page - 1})">Previous</a>
                    </li>
                }

                @for (int i = ViewBag.Page - 2; i <= ViewBag.Page + 2 && i <= Model.TotalCount / 4 + 1; i++)
                {
                    if (i >= 1)
                    {
                        <li class="page-item @(i == ViewBag.Page ? "active" : "")">
                            <a class="page-link" href="@Url.Action("Index","HotelRooms",new {page=i})">@i</a>
                        </li>
                    }
                }

                @if (ViewBag.Page < Model.TotalCount / 4 + 1)
                {
                    <li class="page-item">
                        <a class="page-link" href="@Url.Action("Index","HotelRooms",new {page=ViewBag.Page + 1})">Next</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="@Url.Action("Index","HotelRooms",new {page=Model.TotalCount / 4 + 1})">Last</a>
                    </li>
                }
            </ul>
        </nav>

    </div>

    <form>
        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="exampleModalLabel">Add Price</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <input type="hidden" id="RoomId" />
                        <div class="col-md-6">
                            <label for="inputCity" class="form-label">Price</label>
                            <input type="number" class="form-control" id="inputPrice">
                        </div>
                        <div class="col-md-6">
                            <label for="inputCity" class="form-label">Discount Price</label>
                            <input type="number" class="form-control" id="inputDiscountPrice">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" onclick="submitForm()">Submit</button>
                    </div>
                </div>
            </div>
        </div>
    </form>
    
</div>
<script>
    function submitForm() {
        js=jQuery.noConflict();
        var id = js("#RoomId").val();
        console.log(id);
        var price = js("#inputPrice").val();
        var discountPrice = js("#inputDiscountPrice").val();

        // Perform the AJAX call
        js.ajax({
            url: "/HotelRooms/EditPrice", // replace with your actual URL
            type: "POST",
            data: {
                id: id,
                price: price,
                discountPrice: discountPrice
            },
            success: function (data) {
                // Handle success (if needed)
                console.log("Success:", data);
                location.reload();
            },
            error: function (error) {
                // Handle errors (if needed)
                console.log("Error:", error);
            }
        });
    }
</script>

<script>
    function setModalContent(roomId) {
        // Set the modal content based on roomId
        var modal = document.getElementById('exampleModal');
        var hiddenInput = document.getElementById('RoomId');
        var inputPrice = document.getElementById('inputPrice');
        var inputDiscountPrice = document.getElementById('inputDiscountPrice');

        // Replace the following lines with your actual logic to fetch and set the modal content
        hiddenInput.value = roomId;
        inputPrice.value = ''; // Set the initial value for price
        inputDiscountPrice.value = ''; // Set the initial value for discount price

        // Show the modal
        var myModal = new bootstrap.Modal(modal);
        myModal.show();
    }
</script>